<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>ESS – Room Booking (Test)</title>
</head>
<body>
  <h3>Room Booking Test</h3>

  <label>Room:</label>
  <select id="room">
    <option value="mind">Mind Room</option>
    <option value="power">Power Room</option>
    <option value="reality">Reality Room</option>
    <option value="space">Space Room</option>
  </select>
  <br/><br/>

  <label>Title:</label>
  <input id="title" value="Test Meeting" />
  <br/><br/>

  <label>Start (ISO):</label>
  <input id="start" placeholder="2026-02-11T10:00:00+07:00" />
  <br/><br/>

  <label>End (ISO):</label>
  <input id="end" placeholder="2026-02-11T11:00:00+07:00" />
  <br/><br/>

  <label>Attendees (comma):</label>
  <input id="att" placeholder="a@x.com,b@y.com" />
  <br/><br/>

  <button id="book">Create Meeting</button>
  <pre id="out" style="white-space:pre-wrap"></pre>

<script>
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbxLp9bB6QHjPZ8KRf1FqGJ5am-ubfJqHE2pxgCx_sZEHnOEX8wjIukDCupjOmC9wSow/exec";
const API_KEY = "ESS-ROOM-2026";

const out = (m)=> document.getElementById("out").textContent = m;

document.getElementById("book").onclick = async () => {
  const payload = {
    action: "createMeeting",
    apiKey: API_KEY,
    roomKey: document.getElementById("room").value,
    title: document.getElementById("title").value,
    start: document.getElementById("start").value,
    end: document.getElementById("end").value,
    attendees: document.getElementById("att").value.split(",").map(s=>s.trim()).filter(Boolean),
    organizerEmail: "itmappointasia@gmail.com",
    description: "Created from GitHub Pages"
  };

  try{
    const res = await fetch(WEBAPP_URL, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(payload),
    });

    // ถ้า Apps Script ตอบกลับเป็น JSON ปกติ
    const text = await res.text();
    out(text);
  }catch(err){
    out("ERROR: " + err);
  }
};
</script>
</body>
</html>
